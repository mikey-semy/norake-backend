{
  "info": {
    "name": "Equiply Production API Tests",
    "description": "ðŸš€ **Production API Testing for api.equiply.ru**\n\n## Quick Start\n1. Run \"1. Admin Login\" to get access token\n2. Token auto-saves to collection variables\n3. Run remaining requests in sequence\n\n## Coverage\nâœ… Authentication & Authorization\nâœ… Public endpoints (no auth)\nâœ… Workspace management\nâœ… Issue tracking\nâœ… Comments system\nâœ… Template management\nâœ… Multi-source search (DB + RAG + MCP)\n\n## Variables\n- `base_url`: https://api.equiply.ru\n- `admin_username`: admin\n- `admin_password`: admin123\n- Auto-saved: `access_token`, `workspace_id`, `issue_id`, etc.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{access_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {"key": "base_url", "value": "https://api.equiply.ru", "type": "string"},
    {"key": "admin_username", "value": "admin", "type": "string"},
    {"key": "admin_password", "value": "admin123", "type": "string"},
    {"key": "access_token", "value": "", "type": "string"},
    {"key": "refresh_token", "value": "", "type": "string"},
    {"key": "workspace_id", "value": "", "type": "string"},
    {"key": "issue_id", "value": "", "type": "string"},
    {"key": "comment_id", "value": "", "type": "string"},
    {"key": "template_id", "value": "", "type": "string"}
  ],
  "item": [
    {
      "name": "1ï¸âƒ£ Admin Login",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Admin login successful', () => {",
              "    pm.response.to.have.status(200);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.collectionVariables.set('access_token', data.access_token);",
              "    pm.collectionVariables.set('refresh_token', data.refresh_token);",
              "    ",
              "    console.log('ðŸ”‘ Access token saved:', data.access_token.substring(0, 20) + '...');",
              "    console.log('ðŸ”„ Refresh token saved');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/x-www-form-urlencoded"
          }
        ],
        "body": {
          "mode": "urlencoded",
          "urlencoded": [
            {"key": "username", "value": "{{admin_username}}", "type": "text"},
            {"key": "password", "value": "{{admin_password}}", "type": "text"}
          ]
        },
        "url": {
          "raw": "{{base_url}}/api/v1/auth/login",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "auth", "login"]
        }
      }
    },
    {
      "name": "Health Check",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Health check passed', () => {",
              "    pm.response.to.have.status(200);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.expect(data.app).to.eql('ok');",
              "    pm.expect(data.db).to.eql('ok');",
              "    ",
              "    console.log('ðŸ’š App status:', data.app);",
              "    console.log('ðŸ’¾ Database status:', data.db);",
              "});"
            ]
          }
        }
      ],
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/health",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "health"]
        }
      }
    },
    {
      "name": "2ï¸âƒ£ List Public Issues",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Public issues retrieved', () => {",
              "    pm.response.to.have.status(200);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.expect(data).to.be.an('array');",
              "    ",
              "    console.log('ðŸ“‹ Total public issues:', data.length);",
              "    if (data.length > 0) {",
              "        console.log('ðŸ“ First issue:', data[0].title);",
              "    }",
              "});"
            ]
          }
        }
      ],
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/public/issues",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "public", "issues"]
        }
      }
    },
    {
      "name": "3ï¸âƒ£ List Public Templates",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Public templates retrieved', () => {",
              "    pm.response.to.have.status(200);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.expect(data).to.be.an('array');",
              "    ",
              "    console.log('ðŸ“„ Total public templates:', data.length);",
              "    if (data.length > 0) {",
              "        console.log('ðŸ“ First template:', data[0].name);",
              "    }",
              "});"
            ]
          }
        }
      ],
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/public/templates",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "public", "templates"]
        }
      }
    },
    {
      "name": "4ï¸âƒ£ Create Workspace",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Workspace created', () => {",
              "    pm.response.to.have.status(201);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.collectionVariables.set('workspace_id', data.id);",
              "    ",
              "    console.log('ðŸ¢ Workspace ID:', data.id);",
              "    console.log('ðŸ“› Workspace name:', data.name);",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Test Workspace {{$timestamp}}\",\n  \"description\": \"Created via Postman MCP production test\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/workspaces",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "workspaces"]
        }
      }
    },
    {
      "name": "5ï¸âƒ£ Create Issue",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Issue created', () => {",
              "    pm.response.to.have.status(201);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.collectionVariables.set('issue_id', data.id);",
              "    pm.expect(data.status).to.eql('open');",
              "    ",
              "    console.log('ðŸ“‹ Issue ID:', data.id);",
              "    console.log('ðŸ“ Issue title:', data.title);",
              "    console.log('ðŸ”´ Status:', data.status);",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"title\": \"Production Test Issue {{$timestamp}}\",\n  \"description\": \"Testing issue creation from Postman MCP\",\n  \"status\": \"open\",\n  \"priority\": \"medium\",\n  \"category\": \"equipment\",\n  \"visibility\": \"public\",\n  \"workspace_id\": \"{{workspace_id}}\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/issues",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "issues"]
        }
      }
    },
    {
      "name": "6ï¸âƒ£ Add Issue Comment",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Comment added', () => {",
              "    pm.response.to.have.status(201);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.collectionVariables.set('comment_id', data.id);",
              "    ",
              "    console.log('ðŸ’¬ Comment ID:', data.id);",
              "    console.log('ðŸ“ Content:', data.content);",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"content\": \"Test comment from Postman MCP\",\n  \"parent_id\": null\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/issues/{{issue_id}}/comments",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "issues", "{{issue_id}}", "comments"]
        }
      }
    },
    {
      "name": "7ï¸âƒ£ Create Template",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Template created', () => {",
              "    pm.response.to.have.status(201);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.collectionVariables.set('template_id', data.id);",
              "    pm.expect(data.is_active).to.be.true;",
              "    ",
              "    console.log('ðŸ“„ Template ID:', data.id);",
              "    console.log('ðŸ“ Template name:', data.name);",
              "    console.log('âœ… Active:', data.is_active);",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Test Template {{$timestamp}}\",\n  \"description\": \"Production test template\",\n  \"category\": \"equipment\",\n  \"fields\": [\n    {\"name\": \"serial_number\", \"type\": \"string\", \"required\": true},\n    {\"name\": \"model\", \"type\": \"string\", \"required\": false}\n  ],\n  \"is_active\": true,\n  \"visibility\": \"public\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/templates",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "templates"]
        }
      }
    },
    {
      "name": "8ï¸âƒ£ Search All Sources",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('âœ… Search executed', () => {",
              "    pm.response.to.have.status(200);",
              "    const json = pm.response.json();",
              "    pm.expect(json.success).to.be.true;",
              "    ",
              "    const data = json.data;",
              "    pm.expect(data).to.have.property('results');",
              "    ",
              "    console.log('ðŸ” Total results:', data.results.length);",
              "    console.log('ðŸ“Š Sources used:', Object.keys(data.results_by_source || {}));",
              "    ",
              "    if (data.results_by_source) {",
              "        Object.entries(data.results_by_source).forEach(([source, results]) => {",
              "            console.log(`  - ${source}: ${results.length} results`);",
              "        });",
              "    }",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"query\": \"equipment\",\n  \"sources\": [\"db\", \"rag\", \"mcp\"],\n  \"limit\": 10\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/search",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "search"]
        }
      }
    }
  ]
}
