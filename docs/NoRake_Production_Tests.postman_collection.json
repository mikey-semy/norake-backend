{
  "info": {
    "_postman_id": "dcd5aab9-9244-44c4-9b78-243d0a62c8fb",
    "name": "Equiply Production Tests - api.equiply.ru",
    "description": "ğŸš€ **Production Testing for Equiply Backend**\n\nâœ… All critical endpoints covered\nâœ… Automated token management\nâœ… Real production environment: https://api.equiply.ru\n\n**Quick Start:**\n1. Run \"1. Admin Login\" first\n2. Run remaining tests sequentially\n3. Check test results for each endpoint\n\n**Coverage:**\n- Authentication & Authorization\n- Public APIs (no auth required)\n- Protected APIs (admin access)\n- CRUD operations (Workspaces, Issues, Templates)\n- Search system (DB + RAG + MCP)\n- Comment system",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [{
      "key": "token",
      "value": "{{access_token}}",
      "type": "string"
    }]
  },
  "variable": [
    {"key": "base_url", "value": "https://api.equiply.ru", "type": "string"},
    {"key": "admin_username", "value": "admin", "type": "string"},
    {"key": "admin_password", "value": "admin123", "type": "string"},
    {"key": "access_token", "value": "", "type": "string"},
    {"key": "refresh_token", "value": "", "type": "string"},
    {"key": "workspace_id", "value": "", "type": "string"},
    {"key": "issue_id", "value": "", "type": "string"},
    {"key": "comment_id", "value": "", "type": "string"},
    {"key": "template_id", "value": "", "type": "string"}
  ],
  "item": [
    {
      "name": "1. Admin Login",
      "id": "4878abcf-33ad-499d-530f-df248233cec2",
      "request": {
        "auth": {"type": "noauth"},
        "method": "POST",
        "header": [{"key": "Content-Type", "value": "application/x-www-form-urlencoded"}],
        "body": {
          "mode": "urlencoded",
          "urlencoded": [
            {"key": "username", "value": "{{admin_username}}"},
            {"key": "password", "value": "{{admin_password}}"}
          ]
        },
        "url": {
          "raw": "{{base_url}}/api/v1/auth/login",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "auth", "login"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Admin login successful', () => {",
            "    pm.response.to.have.status(200);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.collectionVariables.set('access_token', data.access_token);",
            "    pm.collectionVariables.set('refresh_token', data.refresh_token);",
            "    console.log('ğŸ”‘ Access token saved');",
            "});"
          ]
        }
      }],
      "uid": "49544679-4878abcf-33ad-499d-530f-df248233cec2"
    },
    {
      "name": "Health Check",
      "id": "258b360f-0547-dabe-3fa3-22516f0556fd",
      "request": {
        "auth": {"type": "noauth"},
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/health",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "health"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Health check passed', () => {",
            "    pm.response.to.have.status(200);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.expect(data.app).to.eql('ok');",
            "    pm.expect(data.db).to.eql('ok');",
            "    console.log('ğŸ’š All services healthy');",
            "});"
          ]
        }
      }],
      "uid": "49544679-258b360f-0547-dabe-3fa3-22516f0556fd"
    },
    {
      "name": "2. List Public Issues",
      "id": "ed61c259-9b41-1805-4956-35da9953ea1c",
      "request": {
        "auth": {"type": "noauth"},
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/public/issues",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "public", "issues"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Public issues retrieved', () => {",
            "    pm.response.to.have.status(200);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.expect(data).to.be.an('array');",
            "    console.log('ğŸ“‹ Public issues:', data.length);",
            "});"
          ]
        }
      }],
      "uid": "49544679-ed61c259-9b41-1805-4956-35da9953ea1c"
    },
    {
      "name": "3. List Public Templates",
      "id": "f965ccac-e230-d9fa-1a1e-8ebc570073b0",
      "request": {
        "auth": {"type": "noauth"},
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/public/templates",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "public", "templates"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Public templates retrieved', () => {",
            "    pm.response.to.have.status(200);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.expect(data).to.be.an('array');",
            "    console.log('ğŸ“„ Public templates:', data.length);",
            "});"
          ]
        }
      }],
      "uid": "49544679-f965ccac-e230-d9fa-1a1e-8ebc570073b0"
    },
    {
      "name": "4. Create Workspace",
      "id": "2a972147-5757-dd6f-2165-4b93de60ceed",
      "request": {
        "method": "POST",
        "header": [{"key": "Content-Type", "value": "application/json"}],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Test Workspace {{$timestamp}}\",\n  \"description\": \"Created via Postman MCP production test\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/workspaces",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "workspaces"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Workspace created', () => {",
            "    pm.response.to.have.status(201);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.collectionVariables.set('workspace_id', data.id);",
            "    console.log('ğŸ¢ Workspace ID:', data.id);",
            "});"
          ]
        }
      }],
      "uid": "49544679-2a972147-5757-dd6f-2165-4b93de60ceed"
    },
    {
      "name": "5. Create Issue",
      "id": "bff1ecc5-51ce-315c-096f-ea5ee689274e",
      "request": {
        "method": "POST",
        "header": [{"key": "Content-Type", "value": "application/json"}],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"title\": \"Production Test Issue {{$timestamp}}\",\n  \"description\": \"Testing issue creation from Postman MCP\",\n  \"status\": \"open\",\n  \"priority\": \"medium\",\n  \"category\": \"equipment\",\n  \"visibility\": \"public\",\n  \"workspace_id\": \"{{workspace_id}}\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/issues",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "issues"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Issue created', () => {",
            "    pm.response.to.have.status(201);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.collectionVariables.set('issue_id', data.id);",
            "    pm.expect(data.status).to.eql('open');",
            "    console.log('ğŸ“‹ Issue ID:', data.id);",
            "});"
          ]
        }
      }],
      "uid": "49544679-bff1ecc5-51ce-315c-096f-ea5ee689274e"
    },
    {
      "name": "6. Add Issue Comment",
      "id": "8df43797-d7c2-841e-359d-9200f8286825",
      "request": {
        "method": "POST",
        "header": [{"key": "Content-Type", "value": "application/json"}],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"content\": \"Test comment from Postman MCP\",\n  \"parent_id\": null\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/issues/{{issue_id}}/comments",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "issues", "{{issue_id}}", "comments"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Comment added', () => {",
            "    pm.response.to.have.status(201);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.collectionVariables.set('comment_id', data.id);",
            "    console.log('ğŸ’¬ Comment ID:', data.id);",
            "});"
          ]
        }
      }],
      "uid": "49544679-8df43797-d7c2-841e-359d-9200f8286825"
    },
    {
      "name": "7. Create Template",
      "id": "ac9ed897-ec26-b427-1b47-c3337e8007b0",
      "request": {
        "method": "POST",
        "header": [{"key": "Content-Type", "value": "application/json"}],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Test Template {{$timestamp}}\",\n  \"description\": \"Production test template\",\n  \"category\": \"equipment\",\n  \"fields\": [\n    {\"name\": \"serial_number\", \"type\": \"string\", \"required\": true},\n    {\"name\": \"model\", \"type\": \"string\", \"required\": false}\n  ],\n  \"is_active\": true,\n  \"visibility\": \"public\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/templates",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "templates"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Template created', () => {",
            "    pm.response.to.have.status(201);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.collectionVariables.set('template_id', data.id);",
            "    pm.expect(data.is_active).to.be.true;",
            "    console.log('ğŸ“„ Template ID:', data.id);",
            "});"
          ]
        }
      }],
      "uid": "49544679-ac9ed897-ec26-b427-1b47-c3337e8007b0"
    },
    {
      "name": "8. Search All Sources",
      "id": "12d8fd88-7a34-b3a1-93e2-d1c1f606613d",
      "request": {
        "method": "POST",
        "header": [{"key": "Content-Type", "value": "application/json"}],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"query\": \"equipment\",\n  \"sources\": [\"db\", \"rag\", \"mcp\"],\n  \"limit\": 10\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/search",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "search"]
        }
      },
      "event": [{
        "listen": "test",
        "script": {
          "exec": [
            "pm.test('âœ… Search executed', () => {",
            "    pm.response.to.have.status(200);",
            "    const json = pm.response.json();",
            "    pm.expect(json.success).to.be.true;",
            "    const data = json.data;",
            "    pm.expect(data).to.have.property('results');",
            "    console.log('ğŸ” Search results:', data.results.length);",
            "    console.log('ğŸ“Š Sources used:', Object.keys(data.results_by_source || {}));",
            "});"
          ]
        }
      }],
      "uid": "49544679-12d8fd88-7a34-b3a1-93e2-d1c1f606613d"
    }
  ]
}
